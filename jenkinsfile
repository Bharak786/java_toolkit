pipeline {
    agent any

    parameters {
        activeChoiceReactiveParam('JAVA_VERSION') {
            description('Select the Java version')
            choices([
                '8',
                '11',
                '17'
            ])
            script {
                return this.choiceValue.toUpperCase()
            }
        }
    }
    
    stages {
        stage('Build Java image') {
            steps {
                script {
                dir('/var/lib/jenkins/workspace/') {
                    docker.build("syed-java:${params.JAVA_VERSION}", "--build-arg JAVA_VERSION=${params.JAVA_VERSION} --target java-builder .")
                  }  
                }
            }
        }
    }
}
